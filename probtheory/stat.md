# Математическая статистика

Статистические тесты
-

Общая идея в сравнении гипотез, а не прямом доказательстве (которое невозможно).

1. Гипотезы
0. Статистический критерий, статистический тест - как он выглядит в общем виде
0. Статистика критерия - функция, в которую заложена проверка
0. Область принятия, критическая область
0. Основные примеры критических областей
0. p_value - удобное обобщение для уровня значимости
0. Ошибки статистических тестов

### Гипотезы
$H_0$ - **нулевая гипотеза** - предположение человека, находившегося в коме, до того, как ему задали соответствующий вопрос или инопланетянина (нет никакой связи, все хорошо и все здоровы)

$H_1$ - **альтернативная гипотеза** - предположение, которое хотим доказать.

### Статистический критерий, статистический тест

$\delta(\vec X, H_0, H_1, \alpha) = \left\{\begin{matrix}\text{accept } H_0\cr\text{reject }H_0\text{, more like }H_1\end{matrix}\right.$

$\vec X$ - выборка в самом широком смысле.

$\alpha$ - уровень значимости. Чем меньше, тем достовернее будет проверка, что $H_0$ неверна и скорее верна $H_1$. Обычно, $\alpha \in \left\{0.1, 0.05, 0.001\right\}$

### Статистика критерия

$T(\vec X) \cong U \sim G$

$T$ - функция от выборки, такая, что при условии $H_0$, случайная величина $T(\vec X)$ имеет распределение $G$ либо стремится к нему при $n \rightarrow \infty$.

### Область принятия, критическая область

Область принятия $T_0(\alpha)$ - область, при подании $T(\vec x)$ в которую, считаем, что верна $H_0$. Вероятость попасть туда $\approx 1-\alpha$.

Критическая область $T_1(\alpha)$ - область, при подании в которую, считаем, что $H_0$ неверна. Шанс в нее попасть должен быть $\approx \alpha$.

Тогда функция $\delta$ выглядит примерно так:

```d
δ(x, α):
  if T(x) in T(1, α):
    reject H0
  else:
    accept H0
```

### Основные примеры критических областей

1. $T_1(\alpha) = \left[q_{1-\alpha},+\infty\right)$ - правосторонняя, right-sided
0. $T_1(\alpha) = \left(-\infty, q_{\alpha}\right]$ - левосторонняя, left-sided
0. $T_0(\alpha) = \overline{T_1(\alpha)} = \left(q_{\frac{\alpha}{2}},q_{1-\frac{\alpha}{2}}\right)$ - двусторонняя, both-sided

![](images/critical-sections.png)

### p_value

Если пользоваться просто критическими областями, то надо будет сообщать пользователю: тип области, значение квантиля, значение $T(\vec x)$ и результат сравнения.

Можно это обобщить, введя p_value = $p$. Оно обозначает **шанс, что значение $U$ экстримальнее, чем $T(x)$**:

$$p(\vec x)=P(U \text{ more in }T_1(\alpha)\text{ than }T(\vec x))$$

В случаях областей выше, это будет:
1. right-sided: $p_r = P(U>T(\vec x)|H_0)$
0. left-sided: $p_l = P(U<T(\vec x)|H_0)$
0. both-sided: $p_b = 2\min(p_l, p_r)$

Тогда достаточно будет сравнить $\alpha$ и $p$.
- $p<\alpha$ - reject $H_0$
- $p>\alpha$ - accept $H_0$

То есть проверку $T(\vec x) \in T_1(\alpha)$ можно теперь заменить на $p(\vec x) < \alpha$.

### Ошибки статистических тестов
|test\\real|$H_0$|$H_1$|
|-|-|-|
|$H_0$|true-positive|false-negative (II рода, $\beta$)|
|$H_1$|false-positive (I рода, $\alpha$)|true-positive|

Запомнить когда 1 а когда 2 рода можно так: $1=01_2$, $2=10_2$.

Ошибка false-negative ($\beta$) хуже, так как это может привести (например, пациента) к фатальным последствиям.

- $\alpha = P(\text{false-positive})$
- $\beta = P(\text{false-negative})$

**Состоятельность теста:** $\beta \rightarrow 0$ при $n \rightarrow \infty$.

В общем случае, $\alpha$ и $\beta$ зависят друг от друга, при том обратно (меньше $\alpha$ - больше $\beta$).

### Итог

Полезные теоремы в кучу
-

$S_* = \frac{1}{n}\sum\limits_{k=0}^{n}(X_k-\overline X)^2$ - смещенная дисперсия (так получилось, что интуитивная формула подвела)

$S = \frac{1}{n-1}\sum\limits_{k=0}^{n}(X_k-\overline X)^2 = \frac{n-1}{n}S_*$ - несмещенная дисперсия.

**ЦПТ:** $\sqrt{n}(X - \overline X)\stackrel{\text d}{\rightarrow}\mathcal{N}(0,\sigma^2)$



